<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MESQUITE: Mesquite::TetLagrangeShape Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespaceMesquite.html">Mesquite</a>::<a class="el" href="classMesquite_1_1TetLagrangeShape.html">TetLagrangeShape</a></div>
<h1>Mesquite::TetLagrangeShape Class Reference</h1><!-- doxytag: class="Mesquite::TetLagrangeShape" --><!-- doxytag: inherits="Mesquite::MappingFunction3D" -->Lagrange shape function for tetrahedral elements.  
<a href="#_details">More...</a>
<p>
Inheritance diagram for Mesquite::TetLagrangeShape:<p><center><img src="classMesquite_1_1TetLagrangeShape__inherit__graph.png" border="0" usemap="#Mesquite_1_1TetLagrangeShape__inherit__map" alt="Inheritance graph"></center>
<map name="Mesquite_1_1TetLagrangeShape__inherit__map">
<area href="classMesquite_1_1MappingFunction3D.html" shape="rect" coords="24,245,224,373" alt="">
<area href="classMesquite_1_1MappingFunction.html" shape="rect" coords="5,5,243,197" alt="">
</map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for Mesquite::TetLagrangeShape:<p><center><img src="classMesquite_1_1TetLagrangeShape__coll__graph.png" border="0" usemap="#Mesquite_1_1TetLagrangeShape__coll__map" alt="Collaboration graph"></center>
<map name="Mesquite_1_1TetLagrangeShape__coll__map">
<area href="classMesquite_1_1MappingFunction3D.html" shape="rect" coords="24,245,224,373" alt="">
<area href="classMesquite_1_1MappingFunction.html" shape="rect" coords="5,5,243,197" alt="">
</map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center><a href="classMesquite_1_1TetLagrangeShape-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="namespaceMesquite.html#62db9e8a37d0fb86f47523b9bdbac930">EntityTopology</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMesquite_1_1TetLagrangeShape.html#c8c56f4a264992992f5b36668e59bae1">element_topology</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get <a class="el" href="namespaceMesquite.html#62db9e8a37d0fb86f47523b9bdbac930">Mesquite::EntityTopology</a> handled by this mapping function.  <a href="#c8c56f4a264992992f5b36668e59bae1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMesquite_1_1TetLagrangeShape.html#62ec86a7bb109e4f8cb42c0b5e39d348">num_nodes</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get number of nodes in the element type.  <a href="#62ec86a7bb109e4f8cb42c0b5e39d348"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMesquite_1_1TetLagrangeShape.html#79c5ea433320b0861e355840c5cfe1e9">sample_points</a> (<a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a> higher_order_nodes) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get sample points at which to evaluate mapping function.  <a href="#79c5ea433320b0861e355840c5cfe1e9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMesquite_1_1TetLagrangeShape.html#4a1f50e74ef97fdbe7e71936d81b5ad0">coefficients</a> (<a class="el" href="structMesquite_1_1Sample.html">Sample</a> location, <a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a> nodeset, double *coeff_out, size_t *indices_out, size_t &amp;num_coeff_out, <a class="el" href="classMesquite_1_1MsqError.html">MsqError</a> &amp;err) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping Function Coefficients.  <a href="#4a1f50e74ef97fdbe7e71936d81b5ad0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMesquite_1_1TetLagrangeShape.html#3c011e793dfa58c4789100648d280cf9">derivatives</a> (<a class="el" href="structMesquite_1_1Sample.html">Sample</a> location, <a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a> nodeset, size_t *vertex_indices_out, <a class="el" href="classMesquite_1_1MsqVector.html">MsqVector</a>&lt; 3 &gt; *d_coeff_d_xi_out, size_t &amp;num_vtx, <a class="el" href="classMesquite_1_1MsqError.html">MsqError</a> &amp;err) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping Function Derivatives.  <a href="#3c011e793dfa58c4789100648d280cf9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMesquite_1_1TetLagrangeShape.html#24e2d60f2179df0814aca8b4f98bba77">ideal</a> (<a class="el" href="structMesquite_1_1Sample.html">Sample</a> location, <a class="el" href="classMesquite_1_1MsqMatrix.html">MsqMatrix</a>&lt; 3, 3 &gt; &amp;jacobian_out, <a class="el" href="classMesquite_1_1MsqError.html">MsqError</a> &amp;err) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get ideal Jacobian matrix.  <a href="#24e2d60f2179df0814aca8b4f98bba77"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Lagrange shape function for tetrahedral elements. 
<p>
This class implements the <a class="el" href="classMesquite_1_1MappingFunction.html">MappingFunction</a> interface, providing a Lagrange shape function for a 10-node tet.<p>
<img class="formulaInl" alt="$\vec{x}(r,s,t) = sum_{i=0}^{n-1} N_i(r,s,t) \vec{x_i}$" src="form_21.png"><p>
<img class="formulaInl" alt="$N_1 = u(2u - 1)$" src="form_22.png"><p>
<img class="formulaInl" alt="$N_2 = r(2r - 1)$" src="form_23.png"><p>
<img class="formulaInl" alt="$N_3 = s(2s - 1)$" src="form_24.png"><p>
<img class="formulaInl" alt="$N_4 = t(2t - 1)$" src="form_25.png"><p>
<img class="formulaInl" alt="$N_5 = 4ru$" src="form_26.png"><p>
<img class="formulaInl" alt="$N_6 = 4rs$" src="form_27.png"><p>
<img class="formulaInl" alt="$N_7 = 4su$" src="form_28.png"><p>
<img class="formulaInl" alt="$N_8 = 4tu$" src="form_29.png"><p>
<img class="formulaInl" alt="$N_9 = 4rt$" src="form_30.png"><p>
<img class="formulaInl" alt="$N_10 = 4st$" src="form_31.png"><p>
<img class="formulaInl" alt="$u = 1 - r - s - t$" src="form_32.png"> 
<p>

<p>
Definition at line <a class="el" href="TetLagrangeShape_8hpp-source.html#l00070">70</a> of file <a class="el" href="TetLagrangeShape_8hpp-source.html">TetLagrangeShape.hpp</a>.<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="c8c56f4a264992992f5b36668e59bae1"></a><!-- doxytag: member="Mesquite::TetLagrangeShape::element_topology" ref="c8c56f4a264992992f5b36668e59bae1" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMesquite.html#62db9e8a37d0fb86f47523b9bdbac930">EntityTopology</a> Mesquite::TetLagrangeShape::element_topology           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get <a class="el" href="namespaceMesquite.html#62db9e8a37d0fb86f47523b9bdbac930">Mesquite::EntityTopology</a> handled by this mapping function. 
<p>

<p>
Implements <a class="el" href="classMesquite_1_1MappingFunction.html#75be09861eb28301fd0490112f31d92d">Mesquite::MappingFunction</a>.
<p>
Definition at line <a class="el" href="TetLagrangeShape_8cpp-source.html#l00040">40</a> of file <a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a>.
<p>
References <a class="el" href="namespaceMesquite.html#62db9e8a37d0fb86f47523b9bdbac93049a64386bba5b7525f15ef23ddc1ee20">Mesquite::TETRAHEDRON</a>.
</div>
</div><p>
<a class="anchor" name="62ec86a7bb109e4f8cb42c0b5e39d348"></a><!-- doxytag: member="Mesquite::TetLagrangeShape::num_nodes" ref="62ec86a7bb109e4f8cb42c0b5e39d348" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Mesquite::TetLagrangeShape::num_nodes           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get number of nodes in the element type. 
<p>
Get the number of nodes in the element type that the mapping function implements. It is assumed that the result of this function, in combination with the element topology, is sufficient to determine the element type. 
<p>
Implements <a class="el" href="classMesquite_1_1MappingFunction.html#49974ddba4db9f62513a2c23c595518b">Mesquite::MappingFunction</a>.
<p>
Definition at line <a class="el" href="TetLagrangeShape_8cpp-source.html#l00043">43</a> of file <a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a>.
</div>
</div><p>
<a class="anchor" name="79c5ea433320b0861e355840c5cfe1e9"></a><!-- doxytag: member="Mesquite::TetLagrangeShape::sample_points" ref="79c5ea433320b0861e355840c5cfe1e9" args="(NodeSet higher_order_nodes) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a> Mesquite::TetLagrangeShape::sample_points           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a>&nbsp;</td>
          <td class="paramname"> <em>higher_order_nodes</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get sample points at which to evaluate mapping function. 
<p>
Get the points within the element at which TMP quality metrics that are a function of the mapping function Jacobian should be evaluated. The default (which may be overridden by individual mapping functions) is to evaluate at all nodes. 
<p>
Reimplemented from <a class="el" href="classMesquite_1_1MappingFunction.html#b129ef2fb9d5859af59bc9577ef4d3c6">Mesquite::MappingFunction</a>.
<p>
Definition at line <a class="el" href="TetLagrangeShape_8cpp-source.html#l00046">46</a> of file <a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a>.
<p>
References <a class="el" href="NodeSet_8hpp-source.html#l00120">Mesquite::NodeSet::clear()</a>, <a class="el" href="NodeSet_8hpp-source.html#l00130">Mesquite::NodeSet::have_any_mid_node()</a>, <a class="el" href="NodeSet_8hpp-source.html#l00301">Mesquite::NodeSet::set_all_corner_nodes()</a>, <a class="el" href="NodeSet_8hpp-source.html#l00179">Mesquite::NodeSet::set_mid_region_node()</a>, and <a class="el" href="namespaceMesquite.html#62db9e8a37d0fb86f47523b9bdbac93049a64386bba5b7525f15ef23ddc1ee20">Mesquite::TETRAHEDRON</a>.
</div>
</div><p>
<a class="anchor" name="4a1f50e74ef97fdbe7e71936d81b5ad0"></a><!-- doxytag: member="Mesquite::TetLagrangeShape::coefficients" ref="4a1f50e74ef97fdbe7e71936d81b5ad0" args="(Sample location, NodeSet nodeset, double *coeff_out, size_t *indices_out, size_t &amp;num_coeff_out, MsqError &amp;err) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mesquite::TetLagrangeShape::coefficients           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMesquite_1_1Sample.html">Sample</a>&nbsp;</td>
          <td class="paramname"> <em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a>&nbsp;</td>
          <td class="paramname"> <em>nodeset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>coeff_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>indices_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&nbsp;</td>
          <td class="paramname"> <em>num_coeff_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1MsqError.html">MsqError</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mapping Function Coefficients. 
<p>
This function returns the list of scalar values (<img class="formulaInl" alt="$N_i$" src="form_98.png">'s) resulting from the evaluation of the mapping function coefficient terms <img class="formulaInl" alt="$N_1(\vec{\xi}), N_2(\vec{\xi}), \ldots, N_n(\vec{\xi})$" src="form_99.png"> for a given <img class="formulaInl" alt="$\vec{\xi}$" src="form_100.png">. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>location</em>&nbsp;</td><td>Where within the element at which to evaluate the coefficients. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nodeset</em>&nbsp;</td><td>List of which nodes are present in the element. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>coefficients_out</em>&nbsp;</td><td>The coefficients (<img class="formulaInl" alt="$N_i(\vec{\xi})$" src="form_101.png">) for each vertex in the element. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>indices_out</em>&nbsp;</td><td>The index ($i$ in $N_i$) for each term in 'coeffs_out'. The assumption is that mapping function implementations will not return zero coefficients. This is not required, but for element types with large numbers of nodes it may have a significant impact on performance. </td></tr>
  </table>
</dl>

<p>
Implements <a class="el" href="classMesquite_1_1MappingFunction.html#50d71c8a6f70f9b0bce70009952efd75">Mesquite::MappingFunction</a>.
<p>
Definition at line <a class="el" href="TetLagrangeShape_8cpp-source.html#l00249">249</a> of file <a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a>.
<p>
References <a class="el" href="Sample_8hpp-source.html#l00059">Mesquite::Sample::dimension</a>, <a class="el" href="NodeSet_8hpp-source.html#l00139">Mesquite::NodeSet::have_any_mid_face_node()</a>, <a class="el" href="NodeSet_8hpp-source.html#l00142">Mesquite::NodeSet::have_any_mid_region_node()</a>, <a class="el" href="classMesquite_1_1MsqError.html#810d503b59129a9369511a41f4dbb1bd70efdd15ac5be735916008eb201fc8e2">Mesquite::MsqError::INVALID_ARG</a>, <a class="el" href="MsqError_8hpp-source.html#l00077">MSQ_SETERR</a>, <a class="el" href="Sample_8hpp-source.html#l00072">Mesquite::Sample::number</a>, and <a class="el" href="classMesquite_1_1MsqError.html#810d503b59129a9369511a41f4dbb1bdcd7e2b2d0ef4c94ba1289543be644e4d">Mesquite::MsqError::UNSUPPORTED_ELEMENT</a>.
</div>
</div><p>
<a class="anchor" name="3c011e793dfa58c4789100648d280cf9"></a><!-- doxytag: member="Mesquite::TetLagrangeShape::derivatives" ref="3c011e793dfa58c4789100648d280cf9" args="(Sample location, NodeSet nodeset, size_t *vertex_indices_out, MsqVector&lt; 3 &gt; *d_coeff_d_xi_out, size_t &amp;num_vtx, MsqError &amp;err) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mesquite::TetLagrangeShape::derivatives           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMesquite_1_1Sample.html">Sample</a>&nbsp;</td>
          <td class="paramname"> <em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1NodeSet.html">NodeSet</a>&nbsp;</td>
          <td class="paramname"> <em>nodeset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>vertex_indices_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1MsqVector.html">MsqVector</a>&lt; 3 &gt; *&nbsp;</td>
          <td class="paramname"> <em>d_coeff_d_xi_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&nbsp;</td>
          <td class="paramname"> <em>num_vtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1MsqError.html">MsqError</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mapping Function Derivatives. 
<p>
This group of methods return the partial derivatives of the mapping function coefficient terms <img class="formulaInl" alt="$\nabla N_1(\vec{\xi}), \nabla N_2(\vec{\xi}), \ldots, \nabla N_n(\vec{\xi})$" src="form_102.png"> evaluated for a given <img class="formulaInl" alt="$\vec{\xi}$" src="form_100.png">, where <img class="formulaInl" alt="$\vec{x_i}$" src="form_91.png"> is a point in <img class="formulaInl" alt="$\mathbf{R}^3$" src="form_92.png"> (i.e. <img class="formulaInl" alt="$x_i,y_i,z_i$" src="form_93.png">). <img class="formulaInl" alt="$\vec{\xi_i} = \left\{\begin{array}{c}\xi_i\\ \eta_i\\ \end{array}\right\}$" src="form_94.png"> for surface elements and <img class="formulaInl" alt="$\vec{\xi_i} = \left\{\begin{array}{c}\xi_i\\ \eta_i\\ \zeta_i\\ \end{array}\right\}$" src="form_95.png"> for volume elements.<p>
The list of returned partial derivatives may be considered list of elements of a matrix <img class="formulaInl" alt="$\mathbf{D}$" src="form_103.png"> in row major order. For surface elements, <img class="formulaInl" alt="$\mathbf{D}$" src="form_103.png"> is a <img class="formulaInl" alt="$n\times 2$" src="form_104.png"> matrix and for volume elements it is a <img class="formulaInl" alt="$n \times 3$" src="form_105.png"> matrix. Each row of <img class="formulaInl" alt="$\mathbf{D}$" src="form_103.png"> corresponds to one of the coefficient functions <img class="formulaInl" alt="$N_i(\vec{\xi})$" src="form_101.png"> and each column corresponds to one of the components of <img class="formulaInl" alt="$\vec{\xi}$" src="form_100.png"> that the corresponding coefficient function is differentiated with respect to.<p>
<img class="formulaInl" alt="$ \mathbf{D} = \left[ \begin{array}{ccc} \frac{\delta N_1}{\delta \xi} &amp; \frac{\delta N_1}{\delta \eta} &amp; \ldots \\ \frac{\delta N_2}{\delta \xi} &amp; \frac{\delta N_2}{\delta \eta} &amp; \ldots \\ \vdots &amp; \vdots &amp; \ddots \end{array} \right]$" src="form_106.png"><p>
The Jacobian matrix (<img class="formulaInl" alt="$\mathbf{J}$" src="form_107.png">) of the mapping function can be calculated as follows. Define a matrix <img class="formulaInl" alt="$\mathbf{X}$" src="form_108.png"> such that each column contains the coordinates of the element nodes.<p>
<img class="formulaInl" alt="$ \mathbf{X} = \left[ \begin{array}{ccc} x_1 &amp; x_2 &amp; \ldots \\ y_1 &amp; y_2 &amp; \ldots \\ z_1 &amp; z_2 &amp; \ldots \end{array}\right]$" src="form_109.png"><p>
The Jacobian matrix is then:<p>
<img class="formulaInl" alt="$\mathbf{J} = \mathbf{X} \times \mathbf{D}$" src="form_110.png"><p>
<img class="formulaInl" alt="$\mathbf{X}$" src="form_108.png"> is always <img class="formulaInl" alt="$3\times n$" src="form_111.png">, so <img class="formulaInl" alt="$\mathbf{J}$" src="form_107.png"> is either <img class="formulaInl" alt="$3\times 2$" src="form_112.png"> (surface elements) or <img class="formulaInl" alt="$3\times 3$" src="form_113.png"> (volume elements) depending on the dimensions of <img class="formulaInl" alt="$\mathbf{D}$" src="form_103.png">.<p>
If the Jacobian matrix of the mapping function is considered as a function of the element vertex coordinates <img class="formulaInl" alt="$\mathbf{J}(\vec{x_1},\vec{x_2},\ldots)$" src="form_114.png"> with <img class="formulaInl" alt="$\vec{\xi}$" src="form_100.png"> constant, then the gradient of that Jacobian matrix function (with respect to the vertex coordinates) can be obtained from the same output list of partial deravitves.<p>
<img class="formulaInl" alt="$\frac{\delta \mathbf{J}}{\delta x_i} = \left[ \begin{array}{ccc} \frac{\delta N_i}{\delta \xi} &amp; \frac{\delta N_i}{\delta \eta} &amp; \ldots \\ 0 &amp; 0 &amp; \ldots \\ 0 &amp; 0 &amp; \ldots \end{array} \right]$" src="form_115.png"> <img class="formulaInl" alt="$\frac{\delta \mathbf{J}}{\delta y_i} = \left[ \begin{array}{ccc} 0 &amp; 0 &amp; \ldots \\ \frac{\delta N_i}{\delta \xi} &amp; \frac{\delta N_i}{\delta \eta} &amp; \ldots \\ 0 &amp; 0 &amp; \ldots \end{array} \right]$" src="form_116.png"> <img class="formulaInl" alt="$\frac{\delta \mathbf{J}}{\delta z_i} = \left[ \begin{array}{ccc} 0 &amp; 0 &amp; \ldots \\ 0 &amp; 0 &amp; \ldots \\ \frac{\delta N_i}{\delta \xi} &amp; \frac{\delta N_i}{\delta \eta} &amp; \ldots \end{array} \right]$" src="form_117.png"><p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>location</em>&nbsp;</td><td>Where within the element at which to evaluate the derivatives. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nodeset</em>&nbsp;</td><td>List of which nodes are present in the element. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vertices_out</em>&nbsp;</td><td>The list of vertices for which the corresponding coefficient in the mapping function is non-zero. The vertices are specified by their index in the canonical ordering for an element with all mid-nodes present (i.e. first all the corner nodes, then the mid-edge nodes, ...). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>d_coeff_d_xi_out</em>&nbsp;</td><td>The mapping function is composed of a series of coefficient functions <img class="formulaInl" alt="$N_i(\vec{\xi})$" src="form_101.png">, one correspoding to the position <img class="formulaInl" alt="$\vec{x_i}$" src="form_91.png"> of each node in the element such that the mapping function is of the form: <img class="formulaInl" alt="$\vec{x}(\vec{\xi})=\sum_{i=1}^n N_i(\vec{\xi})\vec{x_i}$" src="form_90.png">. For each vertex indicated in vertex_indices_out, this list contains the partial derivatives of the cooresponding coefficient function <img class="formulaInl" alt="$N_i$" src="form_98.png"> with respect to each component of <img class="formulaInl" alt="$\vec{\xi}$" src="form_100.png"> in the same order as the corresponding nodes in vertex_indices_out. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>num_vtx</em>&nbsp;</td><td>Output: The number of vertex indices and derivitive tuples returned in vertices_out and d_coeff_d_xi_out, respectively. </td></tr>
  </table>
</dl>

<p>
Implements <a class="el" href="classMesquite_1_1MappingFunction3D.html#f84bea2cb2b51a426a41e2436ca0a354">Mesquite::MappingFunction3D</a>.
<p>
Definition at line <a class="el" href="TetLagrangeShape_8cpp-source.html#l01053">1053</a> of file <a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a>.
<p>
References <a class="el" href="Sample_8hpp-source.html#l00059">Mesquite::Sample::dimension</a>, <a class="el" href="NodeSet_8hpp-source.html#l00139">Mesquite::NodeSet::have_any_mid_face_node()</a>, <a class="el" href="NodeSet_8hpp-source.html#l00130">Mesquite::NodeSet::have_any_mid_node()</a>, <a class="el" href="NodeSet_8hpp-source.html#l00142">Mesquite::NodeSet::have_any_mid_region_node()</a>, <a class="el" href="classMesquite_1_1MsqError.html#810d503b59129a9369511a41f4dbb1bd70efdd15ac5be735916008eb201fc8e2">Mesquite::MsqError::INVALID_ARG</a>, <a class="el" href="MsqError_8hpp-source.html#l00077">MSQ_SETERR</a>, <a class="el" href="Sample_8hpp-source.html#l00072">Mesquite::Sample::number</a>, and <a class="el" href="classMesquite_1_1MsqError.html#810d503b59129a9369511a41f4dbb1bdcd7e2b2d0ef4c94ba1289543be644e4d">Mesquite::MsqError::UNSUPPORTED_ELEMENT</a>.
</div>
</div><p>
<a class="anchor" name="24e2d60f2179df0814aca8b4f98bba77"></a><!-- doxytag: member="Mesquite::TetLagrangeShape::ideal" ref="24e2d60f2179df0814aca8b4f98bba77" args="(Sample location, MsqMatrix&lt; 3, 3 &gt; &amp;jacobian_out, MsqError &amp;err) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mesquite::TetLagrangeShape::ideal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMesquite_1_1Sample.html">Sample</a>&nbsp;</td>
          <td class="paramname"> <em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1MsqMatrix.html">MsqMatrix</a>&lt; 3, 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>jacobian_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMesquite_1_1MsqError.html">MsqError</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get ideal Jacobian matrix. 
<p>
Returns the Jacobian matrix of an ideal element. The orientation of element or corresponding matrix is arbitrary. The "ideal" element should be scaled such the Jacobian (determinant of the Jacobian matrix) is 1.0.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>location</em>&nbsp;</td><td>Where within the element at which to evaluate the Jacobian. Typically doesn't matter except for degenerate elements (e.g. pyramid as degenerate hex.) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>jacobian_out</em>&nbsp;</td><td>The Jacobian of the mapping function at the specified logical location. </td></tr>
  </table>
</dl>

<p>
Reimplemented from <a class="el" href="classMesquite_1_1MappingFunction3D.html#84b6c97281c60b08ce0a19235d5e99b0">Mesquite::MappingFunction3D</a>.
<p>
Definition at line <a class="el" href="TetLagrangeShape_8cpp-source.html#l01090">1090</a> of file <a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="TetLagrangeShape_8hpp-source.html">TetLagrangeShape.hpp</a><li><a class="el" href="TetLagrangeShape_8cpp-source.html">TetLagrangeShape.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 17 15:58:34 2012 for MESQUITE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
